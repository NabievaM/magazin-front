import{E as l,h as n,q as u,I as d}from"./index-BSL1p-Mq.js";import{a,e as s,s as o,b as c}from"./toast-BTAgaSsw.js";const r="https://api.uzbekstore.uz/api";function f(i){return a.post(r+"/admin/signup",i)}function m(i){return a.put(r+`/admin/update/${i.id}`,i)}function h(i){return a.put(r+`/admin/yourself/${i.id}`,i)}function g(){return a.get(r+"/admin/all")}function p(i){return a.get(r+`/admin/findOne/${i}`)}function y(i){return a.delete(r+`/admin/remove/${i}`)}const A="https://api.uzbekstore.uz/api";function k(i){return a.post(A+"/admin/signin",i)}const T=l("admin",{state:()=>({loading:!1,self_admin:{full_name:"",address:"",password:"",email:"",phone:""},admins:[],singleAdmin:{}}),actions:{async authLogin(i){var t;try{this.loading=!0;const e=await k(i);(t=e==null?void 0:e.data.tokens)!=null&&t.access_token&&(this.self_admin=e.data.user,this.saveUser(e==null?void 0:e.data),window.open(n.resolve({name:u.RT_ADMINS}).href,"_blank"))}catch{s("Elektron pochta yoki Parol noto'g'ri kiritilgan"),this.loading=!1}},saveUser(i){localStorage.setItem("access_token",i==null?void 0:i.tokens.access_token),this.self_admin=i==null?void 0:i.user},clearUser(){localStorage.removeItem("access_token"),this.self_admin={full_name:"",address:"",password:"",email:"",phone:""},n.replace({name:d.RT_LOGIN})},async signup(i){var t;this.loading=!0;try{if((await f(i)).status!==201){s("Admin qo'shishda xatolik! Qayta urinib ko'ring");return}this.loading=!1,o("Muvaffaqiyatli qo`shildi"),n.push({name:u.RT_ADMINS})}catch(e){if(c.isAxiosError(e)){if(((t=e.response)==null?void 0:t.status)===400){s("Hisob ma`lumotlari yaroqsiz!");return}s("Xatolik yuz berdi!")}}},async updateAdmin(i){try{if((await m(i)).status!==200){s("Tahrirlanmadi!");return}o("Admin tahrirlandi!"),n.go(0)}catch(t){if(t instanceof Error){s(t.message);return}}finally{this.loading=!1}},async updateByYourself(i){try{if((await h(i)).status!==200){s("Tahrirlanmadi!");return}o("Tahrirlandi!"),n.go(0)}catch(t){if(t instanceof Error){s(t.message);return}}finally{this.loading=!1}},async getAdmins(){this.loading=!0;try{const i=await g();if(i.status!==200)return;this.loading=!1,this.admins=i==null?void 0:i.data}catch{this.loading=!1}},async fetchOneAdmin(i){this.loading=!0;try{const t=await p(i);if(t.status!==200)return;this.loading=!1,this.singleAdmin=t==null?void 0:t.data}catch(t){if(t instanceof Error){s("Xatolik yuz berdi!");return}}},async deleteAdmin(i){this.loading=!0;try{if((await y(i)).status!==200){s("Admin o'chirilmadi");return}this.loading=!1,o("Admin o'chirildi!"),n.push({name:u.RT_ADMINS})}catch(t){if(t instanceof Error){s(t.message);return}}}}});export{T as u};
